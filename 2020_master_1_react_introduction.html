<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

    <title>reveal-md</title>
    <link rel="stylesheet" href="./css/reveal.css" />
    <link rel="stylesheet" href="./css/theme/black.css" id="theme" />
    <link rel="stylesheet" href="./css/highlight/zenburn.css" />
    <link rel="stylesheet" href="./css/print/paper.css" type="text/css" media="print" />
    <link rel="stylesheet" href="./_assets/assets/styles.css" />

  </head>
  <body>
    <div class="reveal">
      <div class="slides"><section  data-markdown><script type="text/template"># React Introduction

## (MMT-M2019)
</script></section><section  data-markdown><script type="text/template">
# About/Contact

- Thomas Mayrhofer (@webpapaya)
- E-Mail: tmayrhofer.lba@fh-salzburg.ac.at
</script></section><section  data-markdown><script type="text/template">
## React

- Component based library to build composable UIs
- OpenSourced in 2013
- Implemented and Maintained by Facebook
- Learn once, write anywhere
  - React-Native
  - React-Native-Desktop
  - React-Native-Windows
  - React-VR
</script></section><section  data-markdown><script type="text/template">
## Components

> Components let you split the UI into independent, reusable pieces.
[React Docs](https://reactjs.org/docs/components-and-props.html)
</script></section><section ><section data-markdown><script type="text/template">
## React Components

- Main Building block of a React App
  - Describe the look and feel of one section in the UI

```js
const Button = () => {
  return (
    <button type='button'>
      A button
    </button>
  )
}

// Usage
React.renderComponent(<Button />, document.body)
```
</script></section><section data-markdown><script type="text/template">
## JSX

- JavaScript XML
  - extension to write XML in JS
- Allows to combine data preparation with render logic

```js
const Button = () => {
  return (
    <button type='button'>
      A button
    </button>
  )
}
```
</script></section><section data-markdown><script type="text/template">
## React without JSX

- React can be used without JSX

```js
const Button = () => {
  return React.createElement(
    'button',
    { type: 'button' },
    'A button'
  )
}
```
</script></section></section><section ><section data-markdown><script type="text/template">
## Which components do you see

![app](assets/sign_in_wireframe.png)
</script></section><section data-markdown><script type="text/template">
![app](assets/app_wireframe.png)
</script></section></section><section  data-markdown><script type="text/template">
## Types of components

- Possible conceptual structure for components
  - `components/`
    - could be reused in other applications
    - don't have domain logic (eg. Button)
  - `container/<container_name>/organism/`
    - contain domain logic
    - can't be reused in a different application (eg. MoneyTransactionList/SignUp)
</script></section><section  data-markdown><script type="text/template">
# Building the first react component  <!-- .element: class="color--white" -->

## Counter component  <!-- .element: class="color--white" -->

<!-- .slide: data-background="./assets/coding.gif" -->
</script></section><section ><section data-markdown><script type="text/template">
### Embedding expressions

```js
const CurrentTime = () => {
  return (
    <h1>
      {(new Date()).toLocaleDateString()}
    </h1>
  )
}
```
</script></section><section data-markdown><script type="text/template">
### Embedding expressions

```js
const FagoMenu = () => {
  return (
    <a href={`/menu/${(new Date()).toLocaleDateString()}`}>
      Go to todays menu
    </a>
  )
}
```
</script></section><section data-markdown><script type="text/template">
## Conditional rendering

```js
const CurrentTime = () => {
  // ...
  return (
    <h1>
      {isToday
        ? 'Today'
        : 'Not Today' }
    </h1>
  )
}
```
</script></section><section data-markdown><script type="text/template">
## Conditional rendering

```js
const CurrentTime = () => {
  // ...
  return (
    <h1>
      {isToday && 'Today'}
      {!isToday && 'Not today'}
    </h1>
  )
}
```
</script></section><section data-markdown><script type="text/template">
### Loop over arrays

```js
const UserList = ({ users }) => {
  return (
    <ul>
      {users.map((user) => {
        return (<li key={user.id}>{user.name}</li>)
      })}
    </ul>
  )
}
```
</script></section><section data-markdown><script type="text/template">
### key property in loops

- Is required when interating over lists
- Helps react to decide if an element needs to be rerendered
- [Video explanation](https://www.youtube.com/watch?v=kFy5dpzdFsM)
- [Detailed explanation](https://dev.to/jtonzing/the-significance-of-react-keys---a-visual-explanation--56l7)
</script></section></section><section ><section data-markdown><script type="text/template">
## Component composition

- Components can be nested and composed together

![app](assets/tree.png)
</script></section><section data-markdown><script type="text/template">
## React props

- Possibility to customize components
  - Can be seen as component configuration
- Props are passed to the component
  - A component at a lower level of the tree can't modify given props directly

```js
const Button = ({ children, disabled = false }) => {
  return (
    <button disabled={disabled} className='button'>
      {children}
    </button>
  )
}

const usage = <Button disabled>A button</Button>
```
</script></section><section data-markdown><script type="text/template">
# Unidirectional Dataflow
- Props only flow from parent to children
- Parent is responsible to update data
  - might provide callbacks to do so
- set state rerenders all children of component
</script></section></section><section ><section data-markdown><script type="text/template">
# Virtual DOM
- makes DOM updates faster
- after setState subtree is rerendered in memory
- compares DOM to in memory representation
- applies DOM changes when needed
</script></section><section data-markdown><script type="text/template"># React.memo

> `Memoizing' a function makes it faster by trading space for time. It does this by caching the return values of the function in a table. (<https://metacpan.org/pod/Memoize)>
</script></section><section data-markdown><script type="text/template"># React.memo

![app](assets/tree.png)
</script></section><section data-markdown><script type="text/template">
# React.memo
- Caches the rendered component
- Only rerenderes when one of the props changes
  - shallow comparison

```ts
const MyComponent = React.memo(function MyComponent(props) {
  /* render using props */
});
```
</script></section></section><section ><section data-markdown><script type="text/template">
# React State (with Hooks)

- State allows components to by dynamic/interactive

```js
const ToggleButton = ({ onSubmit }) => {
  const [backgroundColor, setBackground] = useState('red')

  return (
    <button
      onClick={() => setBackground(backgroundColor === 'red' ? 'blue' : 'red') }
      style={{ backgroundColor }}
    >
      {children}
    </button>
  )
}
```
</script></section><section data-markdown><script type="text/template">
# React State (without hooks)

```js
class SimpleForm extends React.Component {
  state = { backgroundColor: 'red' };
  render() {
    return (
       <button
        onClick={() => this.setState({
          backgroundColor: backgroundColor === 'red' ? 'blue' : 'red')
        })}
        style={{ backgroundColor }}
      >
        {children}
      </button>
    );
  }
}
```
</script></section><section data-markdown><script type="text/template">
## State vs. Props

| _props_ | _state_ |
--- | --- | ---
Can get initial value from parent Component? | Yes | Yes
Can be changed by parent Component? | Yes | No
Can set default values inside Component?* | Yes | Yes
Can change inside Component? | No | Yes
Can set initial value for child Components? | Yes | Yes
Can change in child Components? | Yes | No

[source](https://github.com/uberVU/react-guide/blob/master/props-vs-state.md)
</script></section></section><section ><section data-markdown><script type="text/template">
### Fragments

- Groups a list of children without adding a dom element

```js
const AComponent = () => {
  return (
    <>
      <label>An input</label>
      <input type="text" />
    </>
  )
}
```
</script></section><section data-markdown><script type="text/template">
## Keyed Fragments

- Same as fragment but a key can be provided (eg.: definition list)

```js
const AComponent = ({ items }) => {
  return (
    <dl>
      {items.map(item => (
        // Without the `key`, React will fire a key warning
        <React.Fragment key={item.id}>
          <dt>{item.term}</dt>
          <dd>{item.description}</dd>
        </React.Fragment>
      ))}
    </dl>
  )
}
```
</script></section></section><section ><section data-markdown><script type="text/template">
# React Hooks

> Hooks allow you to reuse stateful logic without changing your component hierarchy. [React Docs](https://reactjs.org/docs/hooks-intro.html#its-hard-to-reuse-stateful-logic-between-components)
</script></section><section data-markdown><script type="text/template">
### React Hooks

- Introduced recently to reduce boilerplate
- Makes it possible to use state in functional components
  - Previously one had to convert between functional/class components when state introduced
- hooks are prefixed with `use`
- Can't be called inside loops, conditions or nested functions
</script></section><section data-markdown><script type="text/template">
### useState

```js
const App = () => {
  const [count, setCount] = useState(0);
  const handleIncrement = () => setCount(count + 1);

  return (
    <div>
      <div>{count}</div>
      <button onClick={handleIncrement}>Increment by 1</button>
    </div>
  );
}
```
</script></section><section data-markdown><script type="text/template">
### Extract into custom hook

```js
const useCounter = () => {
  const [count, setCount] => useState(0);
  const handleIncrement = () => setCount(count + 1);
  return { count, handleIncrement };
}

const App = () => {
  const {count,handleIncrement} => useCounter();

  return (
    <div>
      <div>{count}</div>
      <button onClick={handleIncrement}>Increment by 1</button>
    </div>
  );
}
```
</script></section></section><section ><section data-markdown><script type="text/template">
### useEffect

```js
// Executed on every rerender
useEffect(() => {})

// Executed when component rendered initially
useEffect(() => {}, [])

// Executed when component rendered initially
// and when variable changes.
useEffect(() => {}, [variable])

// Cleanup when component unmounts (eg. eventHandlers, setInterval/setTimeout)
useEffect(() => {
  // do something fancy
  return () => { console.log('cleanup') }
}, [variable])
```
</script></section><section data-markdown><script type="text/template">
### Previous Example

```js
const useCounter = () => {
  const [count, setCount] => useState(0);
  const handleIncrement = () => setCount(count + 1);
  return { count, handleIncrement };
}

const App = () => {
  const {count,handleIncrement} => useCounter();

  return (
    <div>
      <div>{count}</div>
      <button onClick={handleIncrement}>Increment by 1</button>
    </div>
  );
}
```
</script></section><section data-markdown><script type="text/template">
### Update title with counter

```js
const useCounter = () => {
  const [count, setCount] => useState(0);
  const handleIncrement = () => setCount(count + 1);
  return { count, handleIncrement };
}

const App = () => {
  const {count,handleIncrement} => useCounter();

  // Is executed when component is rendered for the first time
  // And when the counter variable changes.
  useEffect(() => {
    document.title = `Counter clicked ${count} times`;
  }, [count]);

  return (
    <div>
      <div>{count}</div>
      <button onClick={handleIncrement}>Increment by 1</button>
    </div>
  );
}
```
</script></section><section data-markdown><script type="text/template">
### Extract to custom hook

```js
const useCounter = () => {
  const [count, setCount] => useState(0);
  const handleIncrement = () => setCount(count + 1);
  useEffect(() => {
    document.title = `Counter clicked ${count} times`;
  }, [count]);

  return { count, handleIncrement };
}

const App = () => {
  const {count,handleIncrement} => useCounter();

  return (
    <div>
      <div>{count}</div>
      <button onClick={handleIncrement}>Increment by 1</button>
    </div>
  );
}
```
</script></section></section><section ><section data-markdown><script type="text/template">
### React Context API

- Available since the beginning of React
- Prevent "prop drilling"
</script></section><section data-markdown><script type="text/template">
### React Context API

![global state tree](assets/global_state_tree.png)
</script></section><section data-markdown><script type="text/template">
### React Context API

![twitter component tree](assets/twitter_component_tree.gif)
</script></section><section data-markdown><script type="text/template">
### React Context API

![global state tree](assets/local_state_tree.png)
</script></section><section data-markdown><script type="text/template">
### Creating a context

```js
const DEFAULT_VALUE = 1
const MyContext = React.createContext(DEFAULT_VALUE)

const RootComponent = () => {
  return (
    <MyContext.Provider value={2}>
      <ANestedComponent />
    </MyContext.Provider>
  )
}

const ANestedComponent = () => {
  const value = useContext(MyContext)
  return (
    <h1>The value from context is {value}</h1>
  )
}
```
</script></section><section data-markdown><script type="text/template">
### Pitfalls 1

- fine granular context

![global state tree](assets/context_hell.png)
</script></section><section data-markdown><script type="text/template">
### Pitfalls/Tips

- Prefer passing props down to components
  - prefer explicit (pass down) vs implicit (context)
- only use when multiple components need to access same data
  - if possible pass data down
- don't overuse
- values from A context are globals
  - use only a hand full of Context.Providers
  - testing becomes trickier
</script></section><section data-markdown><script type="text/template">
### Other hooks

- [API Reference](https://reactjs.org/docs/hooks-reference.html)
  - useReducer
  - useCallback
  - useMemo
  - useRef
  - useImperativeHandle
  - useLayoutEffect
  - useDebugValue
</script></section></section><section  data-markdown><script type="text/template">
### Task

- Fork/clone the following <https://github.com/webpapaya/fhs-react-redux-starter-kit>
- npm install
- npm run start:storybook
- build a clock component
  - component displays current time in seconds
  - automatically updates itself
  - remove setInterval when component unmounts

- You'll need
  - useEffect, useState
  - setInterval or setTimeout
  - (new Date()).toLocaleTimeString()
</script></section><section ><section data-markdown><script type="text/template">
## React Native

- Create native apps for Android and iOS using React
</script></section><section data-markdown><script type="text/template">
### Key differences 1

- No html tags like div/h1/form/button/...
  - Native tags like View/Text/TouchableOpacity/...
- Subset of css supported
- Interop with native APIs possible
  - eg. push notifications
- No links between pages
</script></section><section data-markdown><script type="text/template">
### Key differences 2

- Text needs to be rendered inside a `<Text>My Text</Text>` component
- No onClick handlers on every dom element
  - Adding a onPress handler needs to use TouchableOpacity
- Deployment is much harder (expo helps with that)
</script></section></section><section ><section data-markdown><script type="text/template">
### CSS in React native

```ts
const Title = (props: { children: ReactNode}) => (
  <Text style={styles.container} numberOfLines={1}>
    { props.children }
  </Text>
)

const styles = StyleSheet.create({
  container: {
    fontSize: 20, // density indepentent pixels
    color: '#00ff00', // regular hex value
  }
})

export default Title
```
</script></section><section data-markdown><script type="text/template">
### CSS in React native

- only a subset of css is supported
  - no pseudo elements (eg: :nth-child, :first-child)
  - no css grids
- flexbox per default (no display: block)
- css: box-shadow: '10px 10px 5px 0px rgba(0,0,0,0.75);'
  - translates to:

```js
const styles = StyleSheet.create({{
  shadowColor: colors.main,
  shadowOffset: { width: 0, height: 2 },
  shadowOpacity: 0.15,
  shadowRadius: 6
})
```
</script></section><section data-markdown><script type="text/template">
### Personal recommendations

- if possible build a PWA or use react.js
  - deployment is much easier
  - deployment to ios test-flight takes up to 2h
    - testing a quick-fix is tough
- use expo
  - helps with setup and upgrades
  - helps with deployment (code signing is done by expo)
    - via: `expo deploy:ios`
- don't try to use the same components in web and native
  - share business logic via npm package and build components twice
</script></section><section data-markdown><script type="text/template">
### Downsides React Native

- e2e tests tougher to write
  - especially with react navigation
- CI is more expensive
  - osx server required (Github recently added a free one)
- no pseudo elements
</script></section><section data-markdown><script type="text/template">
### More infos

- Teams which use react native can come and ask
</script></section></section><section  data-markdown><script type="text/template">
# Feedback

- Questions: tmayrhofer.lba@fh-salzburg.ac.at
- <https://de.surveymonkey.com/r/XQ96YZX>
</script></section></div>
    </div>

    <script src="./lib/js/head.min.js"></script>
    <script src="./js/reveal.js"></script>

    <script>
      function extend() {
        var target = {};
        for (var i = 0; i < arguments.length; i++) {
          var source = arguments[i];
          for (var key in source) {
            if (source.hasOwnProperty(key)) {
              target[key] = source[key];
            }
          }
        }
        return target;
      }

      // Optional libraries used to extend on reveal.js
      var deps = [
        { src: './lib/js/classList.js', condition: function() { return !document.body.classList; } },
        { src: './plugin/markdown/marked.js', condition: function() { return !!document.querySelector('[data-markdown]'); } },
        { src: './plugin/markdown/markdown.js', condition: function() { return !!document.querySelector('[data-markdown]'); } },
        { src: './plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
        { src: './plugin/zoom-js/zoom.js', async: true },
        { src: './plugin/notes/notes.js', async: true },
        { src: './plugin/math/math.js', async: true }
      ];

      // default options to init reveal.js
      var defaultOptions = {
        controls: true,
        progress: true,
        history: true,
        center: true,
        transition: 'default', // none/fade/slide/convex/concave/zoom
        dependencies: deps
      };

      // options from URL query string
      var queryOptions = Reveal.getQueryHash() || {};

      var options = extend(defaultOptions, {}, queryOptions);
    </script>


    <script>
      Reveal.initialize(options);
    </script>
  </body>
</html>
